model2_R2
mtcars
pairs(mtcars)
par(mtcars)
pairs(mtcars)
pairs(mtcars)
plot(mpg ~ wt, data = mtcars)
plot(wt ~ mpg, data = mtcars)
plot(mpg ~ wt, data = mtcars)
plot(mpg ~ disp, data = mtcars)
plot(mpg ~ disp, data = mtcars)
plot(mpg ~ disp, data = mtcars)
plot(mpg ~ disp, data = mtcars)
plot(mpg ~ disp, data = mtcars)
plot(mpg ~ wt, data = mtcars)
plot(mpg ~ disp, data = mtcars)
pairs(mtcars)
plot(mpg ~ hp, data = mtcars)
model3 <- nls(mpg ~ a0 * b1 ^ wt, data = mtcars, start = list(a0 = 30, b1 = 0.1))
summary(model3)
model3 <- nls(mpg ~ a0 * b1 ^ wt, data = mtcars, start = list(a0 = 60, b1 = 0.1))
summary(model3)
model3 <- nls(mpg ~ a0 * b1 ^ wt, data = mtcars, start = list(a0 = 60, b1 = 0.1))
summary(model3)
model3 <- nls(mpg ~ a0 * b1 ^ wt, data = mtcars, start = list(a0 = 50, b1 = 0.1))
summary(model3)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_summary <- summary(model3)
model3_summary
model3_summary$parameters
model3_summary$parameters$Estimate
model3_summary$parameters["Estimate"]
model3_summary$parameters["Estimate"]
model3_summary$parameters.a0
model3_summary$parameters
type(model3_summary$parameters)
model3_summary$parameters
model3_summary$parameters[0]
model3_summary$parameters[1]
model3_summary$parameters[2]
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
plot(mpg ~ disp, data = mtcars)
plot(mpg ~ hp, data = mtcars)
model2_R2
model3 <- nls(mpg ~ a0 * b1 ^ wt, data = mtcars, start = list(a0 = 50, b1 = 0.1))
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
model3_results <- data.frame(pred = a0*b1^mtcars$wt,real=mtcars$mpg)
model3_results <- model3_results %>% mutate(res = real - pred)
model2_results <- model2_results %>% mutate(res = real - pred)
library(tidyverse)
library(dplyr)
library(dplyr)
df <- mtcars
model1 <- lm(mpg ~ cyl + disp + wt + vs, data = mtcars)
summary(model1)
model2 <- lm(mpg ~ cyl + disp + wt, data = mtcars)
summary(model2)
model3 <- lm(mpg ~ cyl + wt, data = mtcars)
summary(model3)
library(minpack.lm)
model2 <- nls(mpg ~ a0 * b1 ^ wt, data = mtcars, start = list(a0 = 1, b1 = 2))
summary(model2)
model2_results<-data.frame(pred=49.65969*0.74559^mtcars$wt,
real=mtcars$mpg)
model2_results
model2_results <- model2_results %>% mutate(res = real - pred)
model2_R2 <- (cor(model2_results$real, model2_results$pred)) ^ 2
model2_R2  # 0.8106254
pairs(mtcars)
plot(mpg ~ wt, data = mtcars)
plot(mpg ~ disp, data = mtcars)
plot(mpg ~ hp, data = mtcars)
model3 <- nls(mpg ~ a0 * b1 ^ wt, data = mtcars, start = list(a0 = 50, b1 = 0.1))
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
model3_results <- data.frame(pred = a0*b1^mtcars$wt,real=mtcars$mpg)
model3_results <- model3_results
%>%
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
model3 <- nls(mpg ~ a0 * b1 ^ disp, data = mtcars, start = list(a0 = 50, b1 = 0.1))
model3 <- nls(mpg ~ a0 * b1 ^ disp, data = mtcars, start = list(a0 = 1, b1 = 2))
# wt = 0.8106253, 50 0.1
# disp
mtcars$disp
# wt = 0.8106253, 50 0.1
# disp
is.na(mtcars$disp)
# wt = 0.8106253, 50 0.1
# disp
sum(is.na(mtcars$disp))
# wt = 0.8106253, 50 0.1
# disp
mtcars$disp
model3 <- nls(mpg ~ a0 * b1 ^ hp, data = mtcars, start = list(a0 = 1, b1 = 2))
model3 <- nls(mpg ~ a0 * b1 ^ hp, data = mtcars, start = list(a0 = 10, b1 = 20))
model3 <- nls(mpg ~ a0 * b1 ^ hp, data = mtcars, start = list(a0 = 10, b1 = 1))
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
model3_results <- data.frame(pred = a0*b1^mtcars$wt,real=mtcars$mpg)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3_results)
summary(model3)
model3 <- nls(mpg ~ a0 * b1 ^ hp, data = mtcars, start = list(a0 = 1, b1 = 1))
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
model3_results <- data.frame(pred = a0*b1^mtcars$wt,real=mtcars$mpg)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
model3 <- nls(mpg ~ a0 * b1 ^ disp, data = mtcars, start = list(a0 = 1, b1 = 1))
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
model3_results <- data.frame(pred = a0*b1^mtcars$wt,real=mtcars$mpg)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
# wt = 0.8106253, 50 0.1
# hp = 0.7541081
mtcars$disp
pairs(mtcars)
mtcars <- mtcars %>%
mutate(cyl8 = (cyl == 8))
mtcars <- mtcars %>%
mutate(cyl4 = (cyl == 4))
summary(model3)
mtcars
model3 <- nls(mpg ~ a0 * b1^wt + b2*cyl4, data = mtcars, start = list(a0 = 15, b1 = 0.5, b2 = 3))
summary(model3)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
b2
model3_results<-data.frame(pred=a0*b1^mtcars$wt+b2*mtcars$cyl4,real=mtcars$mpg)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
model3 <- nls(mpg ~ a0 * b1^wt + b2*cyl8, data = mtcars, start = list(a0 = 15, b1 = 0.5, b2 = 3))
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
model3_results<-data.frame(pred=a0*b1^mtcars$wt+b2*mtcars$cyl4,real=mtcars$mpg)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
model3 <- nls(mpg ~ a0 * b1^wt + b2*cyl4, data = mtcars, start = list(a0 = 15, b1 = 0.5, b2 = 3))
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
model3_results<-data.frame(pred=a0*b1^mtcars$wt+b2*mtcars$cyl4,real=mtcars$mpg)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
model3 <- nls(mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8, data = mtcars, start = list(a0 = 15, b1 = 0.5, b2 = 3))
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8,
data = mtcars,
start = list(a0 = 15, b1 = 0.5, b2 = 3, b3 = 5)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
b3 <- model3_summary$parameters[4]
model3_results<-data.frame(pred=a0*b1^mtcars$wt+b2*mtcars$cyl4,real=mtcars$mpg)
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 * mtcars$cyl4 + b3 * mtcars$cyl8,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
mtcars <- mtcars %>%
mutate(cyl6 = (cyl == 8))
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 15, b1 = 0.5, b2 = 3, b3 = 5)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 15, b1 = 0.5, b2 = 3, b3 = 5, b4 = 10)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 15, b1 = 0.5, b2 = 3, b3 = 5, b4 = 9)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 15, b1 = 0.5, b2 = 3, b3 = 5, b4 = 15)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 15, b1 = 0.5, b2 = 3, b3 = 5, b4 = 11)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 15, b1 = 0.5, b2 = 3, b3 = 5, b4 = 1)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 15, b1 = 0.5, b2 = 3, b3 = 5, b4 = 25)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 15, b1 = 1, b2 = 3, b3 = 5, b4 = 7)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8 + b4 * cyl6,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 8)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 8)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 50)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 9)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 0.1)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 0)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl6,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
b3 <- model3_summary$parameters[4]
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 * mtcars$cyl4 + b3 * mtcars$cyl8,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
mtcars <- mtcars %>%
mutate(cyl6 = (cyl == 6))
mtcars <- mtcars %>%
mutate(cyl4 = (cyl == 4))
mtcars
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl6,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
b3 <- model3_summary$parameters[4]
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 * mtcars$cyl4 + b3 * mtcars$cyl8,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl6 + b4 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 8)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl6 + b4 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 9)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl6 + b4 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5, b4 = 11)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 * cyl4 + b3 * cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
b3 <- model3_summary$parameters[4]
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 * mtcars$cyl4 + b3 * mtcars$cyl8,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 ^ cyl4 + b3 ^ cyl8,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
b3 <- model3_summary$parameters[4]
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 * mtcars$cyl4 + b3 * mtcars$cyl8,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 ^ cyl4,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
b3 <- model3_summary$parameters[4]
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 * mtcars$cyl4 + b3 * mtcars$cyl8,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
# mpg ~ a0 * b1^wt + b2*cyl4, R2 =  0.8446665
model3 <- nls(
mpg ~ a0 * b1^wt + b2 ^ disp + b3 ^ hp,
data = mtcars,
start = list(a0 = 1, b1 = 2, b2 = 3, b3 = 5)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
model3 <- nls(
mpg ~ a0 * b1^wt + b2 ^ disp + b3 ^ hp,
data = mtcars,
start = list(a0 = 50, b1 = 2, b2 = 3, b3 = 5)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 ^ disp + b3 ^ hp,
data = mtcars,
start = list(a0 = 50, b1 = 20, b2 = 30, b3 = 50)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 ^ disp + b3 ^ hp,
data = mtcars,
# start = list(a0 = 50, b1 = 20, b2 = 30, b3 = 50)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 ^ disp + b3 ^ hp,
data = mtcars,
start = list(a0 = 50, b1 = 20, b2 = 30, b3 = 50)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2*cyl4,
data = mtcars,
start = list(a0 = 50, b1 = 20, b2 = 30, b3 = 50)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2*cyl4,
data = mtcars,
start = list(a0 = 50, b1 = 20, b2 = 30)
)
model3 <- nls(
mpg ~ a0 * b1^wt + b2*cyl4,
data = mtcars,
start = list(a0 = 50, b1 = 2, b2 = 3)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
b3 <- model3_summary$parameters[4]
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 * mtcars$cyl4 + b3 * mtcars$cyl8,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 * mtcars$cyl4,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
model3 <- nls(
mpg ~ a0 * b1^wt + b2 ^ cyl4,
data = mtcars,
start = list(a0 = 50, b1 = 2, b2 = 3)
)
model3_summary <- summary(model3)
a0 <- model3_summary$parameters[1]
b1 <- model3_summary$parameters[2]
b2 <- model3_summary$parameters[3]
model3_results<-data.frame(
pred = a0 * b1^mtcars$wt + b2 ^ mtcars$cyl4,
real=mtcars$mpg
)
model3_results <- model3_results %>% mutate(res = real - pred)
model3_R2 <- (cor(model3_results$real, model3_results$pred)) ^ 2
model3_R2
summary(model3)
AirPassengers
df <- AirPassengers
# how I am given the data set to work with
AirPassengers <- as.data.frame(AirPassengers)
# trying to get the data with a yearly trend
AP <- ts(AirPassengers, start = c(1949,1), frequency = 12) # doesn't work with freq = 1
dAP <- decompose(AP, type = "multiplicative")
dAP_trend <- dAP$trend
dAP_trend
plot(AirPassengers)
par(new=TRUE)
plot(dAP_trend, type="l", col="green" )
autoplot(as.zoo(AP), geom = "line") +
geom_line(aes(x = time(dAP_trend), y = dAP_trend), color = "green")
instal.packages("zoo")
install.packages("zoo")
library(zoo)
AirPassengers <- as.data.frame(AirPassengers)
AP <- ts(AirPassengers, start = c(1949,1), frequency = 12) # doesn't work with freq = 1
dAP <- decompose(AP, type = "multiplicative")
dAP_trend <- dAP$trend
dAP_trend
autoplot(as.zoo(AP), geom = "line") +
geom_line(aes(x = time(dAP_trend), y = dAP_trend), color = "green")
air_pass<-read.delim("Series_G.csv", header=FALSE, col.names=c('Passengers', 'Date'))
setwd("/home/student/Repositories/data-mining/cwiczenia4/")
setwd("/home/student/Repositories/data-mining/cwiczenia4/")
library(zoo)
AirPassengers <- as.data.frame(AirPassengers)
AP <- ts(AirPassengers, start = c(1949,1), frequency = 12) # doesn't work with freq = 1
dAP <- decompose(AP, type = "multiplicative")
dAP_trend <- dAP$trend
dAP_trend
# autoplot(as.zoo(AP), geom = "line") +
# geom_line(aes(x = time(dAP_trend), y = dAP_trend), color = "green")
air_pass<-read.delim("Series_G.csv", header=FALSE, col.names=c('Passengers', 'Date'))
air_pass
str(air_pass)
air_pass$Date <- as.Date(air_pass$Date, format = "%d.%m.%Y")
plot(air_pass$Passengers~air_pass$Date, type='l')
acf(air_pass$Passengers, na.action = na.pass)
pacf(air_pass$Passengers, na.action = na.pass)
install.packages("tidyverse")
library(tidyverse)
air_pass$Year <- format(air_pass$Date, "%Y")
air_pass <- air_pass %>%
mutate(IsNewYear=ifelse(format(air_pass$Date, "%m") == "01" , 1, 0))
air_pass <- air_pass %>%
mutate(IsSummer=ifelse(format(air_pass$Date, "%m") == "06"|format(air_pass$Date, "%m") == "07"|format(air_pass$Date, "%m") == "08"|format(air_pass$Date, "%m") == "09" , 1, 0))
